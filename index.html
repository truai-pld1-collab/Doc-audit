<!DOCTYPE html>

<html lang="th">
<head>
<meta charset="utf-8"/>
<title>Audit Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script> 
<link rel="stylesheet" href="style.css?v=20251106_1325"> 
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet"> 
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
</head>
<body>
<div id="loginSection" class="login-box">
  <img alt="Logo" src="logo.png" style="display:block;margin:auto;width:120px;margin-bottom:20px;"/>
  <h2>Login</h2>
  <input id="email" placeholder="Email" type="email"/>
  <input id="password" placeholder="Password" type="password"/>
  <button onclick="login()">Login</button>
</div>

<div id="mainApp" style="display:none; padding: 20px;">
  <div class="nav">
    <div class="nav-left">
      <button id="btnForm" onclick="showSection('form')" class="active">ISSUE</button> 
      <button id="btnTable" onclick="showSection('table')">DATA LIST</button>
      <button id="btnChart" onclick="showSection('chart')">SUMMARY</button>
    </div>
    <div class="nav-right">
      <button onclick="logout()">Logout</button> <img alt="Logo" class="logo" src="image.png"/>
    </div>
  </div>
  
  <div class="section active" id="form">
    <h2 style="text-align:center; color:#333; margin-bottom:20px;">Doc Audit Logistic</h2>
    <form id="auditForm" style="display: flex; flex-direction: column; gap: 12px; max-width: 600px; margin: auto;">
      <input id="partNo" placeholder="Part No" required="" type="text"/>
      <input id="partName" placeholder="Part Name" required="" type="text"/>
      <input id="problem" placeholder="Problem" required="" type="text">
      <input id="issue" placeholder="Issue" required="" type="text">
      <input id="recorder" placeholder="Recorder" required="" type="text"/>
      <input id="causer" placeholder="Causer" required="" type="text"/>
      <select id="docType">
        <option value="Audit LG1">Audit LG1</option>
        <option value="Audit LG2">Audit LG2</option>
      </select>
      
      <label style="font-size: 14px; margin-top: 5px; color: #555;">Image 1 (Optional)</label>
      <input accept="image/*" id="imageInput1" type="file"/> 
      <label style="font-size: 14px; margin-top: 5px; color: #555;">Image 2 (Optional)</label>
      <input accept="image/*" id="imageInput2" type="file"/> 
      
      <input type="submit" value="Submit"/>
    </form>
  </div>

<div class="section" id="table">
    <select id="sheetSelector" onchange="debouncedLoadData()">
      <option value="Audit LG1">Audit LG1</option>
      <option value="Audit LG2">Audit LG2</option>
    </select>
    <input id="fromDate" type="date" onchange="debouncedLoadData()"/>
    <input id="toDate" type="date" onchange="debouncedLoadData()"/>
    <button onclick="exportToExcel()">Export to Excel</button>
    <table id="auditTable">
      <thead>
        <tr>
          <th>Date</th><th>Part No</th><th>Part Name</th><th>Problem</th><th>Issue</th><th>Recorder</th><th>Causer</th><th>Image 1</th><th>Image 2</th> </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
  
  <div class="section" id="chart">
    <input id="chartFromDate" type="date" onchange="loadChartData()"/>
    <input id="chartToDate" type="date" onchange="loadChartData()"/>
    
    <div style="display: flex; justify-content: space-around; flex-wrap: wrap; margin-top: 20px; max-width: 900px; margin-left: auto; margin-right: auto;">
        <canvas id="problemChartLG1" style="max-width: 45%;"></canvas>
        <canvas id="problemChartLG2" style="max-width: 45%;"></canvas>
    </div>
</div>

  <div id="toastNotification" class="toast-hidden">
    ยินดีต้อนรับเข้าสู่ระบบ Doc Audit Logistic!
  </div>

  <div id="imageModal" onclick="closeModal()">
    <img id="modalImage"/>
  </div>
  <script src="script.js?v=20251106_1325"></script>
</div>
</body>
</html>